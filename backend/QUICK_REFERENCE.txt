â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           DevLens API - JWT Authentication Quick Ref          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”‘ AUTHENTICATION FLOW
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. Create user â†’ Passwords automatically hashed with bcrypt
2. Login â†’ Receive JWT token (expires in 30 min)
3. Use token â†’ Include in Authorization: Bearer <token>
4. Access protected endpoints â†’ Validated & authorized

ğŸ“‹ ENDPOINTS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

PUBLIC (No token required):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /users/       Create new user (password auto-hashed)     â”‚
â”‚ POST /login        Get JWT token                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PROTECTED (JWT token required):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /users/{id}    Get user by ID                             â”‚
â”‚                    âœ“ Users: own data only                     â”‚
â”‚                    âœ“ Admins: any user data                    â”‚
â”‚                                                                â”‚
â”‚ GET /users/        Get all users                              â”‚
â”‚                    âœ“ Users: own data only                     â”‚
â”‚                    âœ“ Admins: all user data                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸš€ QUICK START
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 1. Install dependencies
pip install -r requirements.txt

# 2. Update database (IMPORTANT!)
ALTER TABLE users MODIFY COLUMN password VARCHAR(255);

# 3. Change secret key in auth_utils.py (PRODUCTION!)
SECRET_KEY = "your-secure-random-key-here"

# 4. Start server
uvicorn main:app --reload

# 5. Test
python test_auth.py

ğŸ’» USAGE EXAMPLES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# Create user
curl -X POST http://localhost:8000/users/ \
  -H "Content-Type: application/json" \
  -d '{"firstname":"John","lastname":"Doe",
       "email":"john@example.com","password":"pass123","role":"user"}'

# Login
curl -X POST http://localhost:8000/login \
  -H "Content-Type: application/json" \
  -d '{"email":"john@example.com","password":"pass123"}'

# Save the token from response:
TOKEN="eyJhbGciOiJIUzI1NiIs..."

# Access protected endpoint
curl -X GET http://localhost:8000/users/1 \
  -H "Authorization: Bearer $TOKEN"

ğŸ PYTHON CLIENT
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
import requests

# Create user
response = requests.post("http://localhost:8000/users/", 
    json={"firstname":"John","lastname":"Doe",
          "email":"john@example.com","password":"pass123","role":"user"})

# Login
response = requests.post("http://localhost:8000/login",
    json={"email":"john@example.com","password":"pass123"})
token = response.json()["access_token"]

# Access protected endpoint
headers = {"Authorization": f"Bearer {token}"}
response = requests.get("http://localhost:8000/users/1", headers=headers)

ğŸ”’ AUTHORIZATION MATRIX
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Endpoint           â”‚ No Token â”‚ User Token  â”‚ Admin Token
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
POST /users/       â”‚    âœ“     â”‚      âœ“      â”‚      âœ“
POST /login        â”‚    âœ“     â”‚      âœ“      â”‚      âœ“
GET /users/{id}    â”‚    âœ—     â”‚  Own only   â”‚  All users
GET /users/        â”‚    âœ—     â”‚  Own only   â”‚  All users

ğŸ“ KEY FILES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
main.py                  â†’ FastAPI app with protected endpoints
auth_utils.py           â†’ JWT & password utilities
models.py               â†’ User model (password: VARCHAR(255))
requirements.txt        â†’ Updated dependencies
test_auth.py           â†’ Complete test suite
API_USAGE.md           â†’ Detailed documentation
IMPLEMENTATION_SUMMARY.md â†’ This implementation guide

âš™ï¸ CONFIGURATION (auth_utils.py)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
SECRET_KEY = "change-this-in-production"  # âš ï¸ CHANGE THIS!
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 30

# Generate secure key:
python -c "import secrets; print(secrets.token_urlsafe(32))"

ğŸ›¡ï¸ SECURITY FEATURES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ“ Bcrypt password hashing (no plain text storage)
âœ“ JWT tokens with expiration (30 min)
âœ“ OAuth2 Bearer token authentication
âœ“ Role-based access control (admin/user)
âœ“ Token validation on every request
âœ“ Secure password verification (time-constant)

ğŸš¨ COMMON ERRORS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
401 Unauthorized
  â†’ Missing/invalid token or wrong password
  â†’ Solution: Login again to get new token

403 Forbidden
  â†’ User trying to access another user's data
  â†’ Solution: Access own data or use admin account

404 Not Found
  â†’ User ID doesn't exist
  â†’ Solution: Check user ID exists in database

400 Bad Request
  â†’ Email already registered
  â†’ Solution: Use different email or login

ğŸ“š DOCUMENTATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Swagger UI:  http://localhost:8000/docs
ReDoc:       http://localhost:8000/redoc
Full Docs:   API_USAGE.md
Summary:     IMPLEMENTATION_SUMMARY.md

ğŸ§ª TESTING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# Automated test suite
python test_auth.py

# Manual testing with Swagger UI
1. Go to http://localhost:8000/docs
2. Create user with POST /users/
3. Login with POST /login (copy token)
4. Click ğŸ”’ "Authorize" button
5. Enter: Bearer <token>
6. Test protected endpoints

âœ¨ FEATURES IMPLEMENTED
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ“ JWT authentication for login
âœ“ Bcrypt password hashing (not plain text)
âœ“ /login endpoint with JWT token response
âœ“ Protected GET /users/{id} (user/admin access)
âœ“ Protected GET /users/ (user/admin access)
âœ“ POST /users/ with password hashing
âœ“ OAuth2 Bearer token dependency
âœ“ Role-based authorization checks
âœ“ Comprehensive error handling

ğŸ“¦ DEPENDENCIES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
fastapi                â†’ Web framework
uvicorn                â†’ ASGI server
sqlalchemy             â†’ Database ORM
pydantic               â†’ Data validation
bcrypt                 â†’ Password hashing
passlib[bcrypt]        â†’ Password context
python-jose[cryptography] â†’ JWT handling
PyJWT                  â†’ JWT library
python-multipart       â†’ Form data parsing

âš ï¸ IMPORTANT NOTES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. MUST update password column: VARCHAR(255)
2. MUST change SECRET_KEY in production
3. Tokens expire after 30 minutes
4. Repository/Report endpoints unchanged
5. Use HTTPS in production
6. Store tokens securely on client

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  âœ… Ready to use! Start with:                  â•‘
â•‘              uvicorn main:app --reload                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
